@using CampusParty.Services
@using Newtonsoft.Json;
@inject IUsuarioService _usuarioService
@inject IEventoService _eventoService
@inject IPabellonService _pabellonService
@inject IEquipoService _equipoService
@inject IUsuarioEventoService _usuarioEventoService

@{
    Usuario currentUser = _usuarioService.GetAuthenticatedUser(Context);
    IEnumerable<Evento> eventos = _eventoService.GetEventos().ToList().Where(x => x.Estado);
    int carouselCounter = 0;
    var equipos = _equipoService.GetEquipos().ToList();
    var usuarioEventos = _usuarioEventoService.GetUsuarioEventosByUserId(currentUser != null ? currentUser.UsuarioId : 0).ToList();
}

<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Campus Party</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;700&amp;display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;700&amp;display=swap" media="print" onload="this.media='all'" />
    <noscript>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;700&amp;display=swap" />
    </noscript>

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/frontal/main.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/font-awesome/css/all.min.css" asp-append-version="true" />
</head>

<body id="top">
    <div class="site-wrapper">
        <div class="site-wrapper-inner">
            <div class="cover-container">
                <div class="masthead clearfix">
                    <div class="inner">
                        <h2 class="masthead-brand">Campus Party</h2>
                        <nav class="nav nav-masthead">
                            <a class="nav-link text-white" href="#" title="somos"> Quienes Somos</a>
                            <a class="nav-link text-white" href="#" title="futurosEventos"> Futuros Eventos</a>
                            @if (currentUser != null) {
                                
                                <a href="#" class="nav-link text-white dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                    <strong>@currentUser.NombreCompleto</strong>
                                </a>
                                @if (currentUser.Rol != null ? currentUser.Rol.Equals("Admin") : currentUser.RolId == 1) {
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="@Url.Action("Index", "Event")">Panel de administrador</a>
                                        <a class="dropdown-item" href="#" id="logout">Cerrar sesión</a>
                                    </div>
                                } else {
                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                        <a class="dropdown-item" href="#" id="logout">Cerrar sesión</a>
                                    </div> 
                                }

                            } else {
                                <a class="nav-link text-white" href="@Url.Action("Index", "SignIn")" title="sesion"> Iniciar sesión</a>
                            }

                        </nav>
                    </div>
                </div>

                <div class="container mt-5">
                    <div class="inner cover">
                        <h1>Bienvenidos Campuseros </h1>
                    </div>

                    <div id="carouselExampleControls" class="carousel slide pt-5" data-bs-ride="carousel">
                        <div class="carousel-inner">
                            @foreach(Evento evento in eventos){
                                var pabellones = _pabellonService.GetPabellonesByEvento(evento.EventoId).ToList();
                                carouselCounter++;
                                <div class="carousel-item @String.Format("{0}", carouselCounter == 1 ? "active" : String.Empty)">
                                    <h4 class="event-name">@evento.Nombre</h4>
                                    <div class="m-auto mt-3 mb-3 w-50">
                                        <p class="text-white">@evento.Descripcion</p>
                                    </div>
                                    @if (currentUser != null) {
                                        if (!usuarioEventos.Any(x => x.EventoId == evento.EventoId)) {
                                            <p class="lead inscribe-button-container">
                                                <button type="button" data-pabellones="@JsonConvert.SerializeObject(pabellones)" data-equipos="@JsonConvert.SerializeObject(equipos)" data-itemid="@evento.EventoId" class="btn btn-lg btn-default btn-notify open-register-moda-button" data-bs-toggle="modal" data-bs-target="#registerEventModal">
                                                    Inscribete
                                                </button>
                                            </p>
                                        }else{
                                            <p class="lead inscribe-button-container">
                                                <button type="button" class="btn btn-lg btn-default btn-notify" disabled>
                                                    ¡Inscrito!
                                                </button>
                                            </p>
                                        }
                                    }
                                </div>
                            }
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>


                <div class="modal fade" id="subscribeModal" tabindex="-1" role="dialog" aria-labelledby="subscribeModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="subscribeModalLabel">Get Notified on Launch:</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group">
                                        <label for="recipient-name" class="form-control-label">Enter you e-mail to get notified when we launch</label>
                                        <input type="text" class="form-control" id="recipient-name" placeholder="your-name@example.com">
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default">Subscribe</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


        <div class="modal fade" id="registerEventModal" tabindex="-1" aria-labelledby="registerEventModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="registerEventModalLabel">Formulario Inscripción al Evento(<span class="event-title"></span>)</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <form>
                  <div class="row d-flex">
                    <div class="col-md-3">
                      <input type="checkbox" id="carpa" class="form-check-input">
                      <label for="carpa" class="form-check-label">Carpa</label>
                    </div>
                    <div class="col-md-3">
                      <input type="checkbox" id="vehiculo" class="form-check-input">
                      <label for="vehiculo" class="form-check-label">Vehiculo</label>
                    </div>
                    <div class="col-md-3">
                      <input type="checkbox" id="computador" class="form-check-input">
                      <label for="computador" class="form-check-label">Computador</label>
                    </div>
                    <div class="col-md-3">
                      <input type="checkbox" id="estadia" class="form-check-input">
                      <label for="estadia" class="form-check-label">Estadia</label>
                    </div>
                  </div>
                  <hr class="hr hr-blurry">
                  <!--FORMULARIO CARPA-->
                  <div id="formCarpa" class="mt-3 mb-1 d-none">
                    <p class="lead">Datos Carpa</p>
                    <div class="row d-flex">
                      <div class="col-md-3">
                        <label for="color" class="form-label">Color</label>
                        <input type="text" id="color" class="form-control">
                      </div>
                      <div class="col-md-3">
                        <label for="alto" class="form-label">Alto</label>
                        <input type="number" id="alto" class="form-control" step="any">
                      </div>
                      <div class="col-md-3">
                        <label for="largo" class="form-label">Largo</label>
                        <input type="number" id="largo" class="form-control" step="any">
                      </div>
                      <div class="col-md-3">
                        <label for="ancho" class="form-label">Ancho</label>
                        <input type="number" id="ancho" class="form-control" step="any">
                      </div>
                    </div>
                  </div>

                  <!--FORMULARIO VEHICULO-->
                  <div id="formVehiculo" class="mt-3 mb-1 d-none">
                    <p class="lead">Datos Vehiculo</p>
                    <div class="row d-flex">
                      <div class="col-md-6">
                        <label for="placa" class="form-label">Placa</label>
                        <input type="text" id="placa" class="form-control">
                      </div>
                      <div class="col-md-6">
                        <label for="colorVehiculo" class="form-label">Color Vehiculo</label>
                        <input type="text" id="colorVehiculo" class="form-control">
                      </div>
                    </div>
                  </div>

                  <!--FORMULARIO COMPUTADOR-->
                  <div id="formComputador" class="mt-3 mb-1 d-none">
                    <p class="lead">Datos Computador</p>
                    <div class="row d-flex">
                      <div class="col-md-6">
                        <label for="serial" class="form-label">Serial</label>
                        <input type="text" id="serial" class="form-control">
                      </div>
                      <div class="col-md-6">
                        <label for="ram" class="form-label">RAM</label>
                        <input type="number" id="ram" class="form-control">
                      </div>
                      <div class="col-md-6">
                        <label for="discoDuro" class="form-label">Disco Duro (GB)</label>
                        <input type="number" id="discoDuro" class="form-control">
                      </div>
                    </div>
                    <!--FORMULARIO SOFTWARE-->
                    <div id="formSoftware" class="mt-3">
                      <p class="lead" style="font-size: 16px;">Software</p>
                      <div class="row d-flex">
                        <div class="col-md-4">
                          <label for="nombreSoftware" class="form-label">Nombre Software</label>
                          <input type="text" id="nombreSoftware" class="form-control">
                        </div>
                        <div class="col-md-4">
                          <label for="valorSoftware" class="form-label">Valor del Software</label>
                          <input type="number" id="valorSoftware" class="form-control" step="any">
                        </div>
                        <div class="col-md-4">
                          <label for="pesoSoftware" class="form-label">Peso del Software (MB)</label>
                          <input type="number" id="pesoSoftware" class="form-control">
                        </div>
                      </div>
                      <div class="row d-flex mt-2">
                        <div class="col-md-3">
                          <input type="checkbox" id="videojuego" class="form-check-input">
                          <label for="videojuego" class="form-check-label">Tiene Videojuego</label>
                        </div>
                        <div class="col-md-5">
                          <input type="checkbox" id="softwareEducativo" class="form-check-input">
                          <label for="softwareEducativo" class="form-check-label">Tiene Software Educativo</label>
                        </div>
                      </div>
                    </div>
                    <!--FORMULARIO SOFTWARE EDUCATIVO-->
                    <div id="formSoftwareEducativo" class="mt-3 d-none">
                      <p class="lead" style="font-size: 16px;">Datos Software Educativo</p>
                      <div class="row d-flex">
                        <div class="col-md-6">
                          <label for="logros" class="form-label">Logros</label>
                          <input type="text" id="logros" class="form-control">
                        </div>
                      </div>
                    </div>

                    <!--FORMULARIO VIDEOJUEGO-->
                    <div id="formVideojuego" class="mt-3 d-none">
                      <p class="lead" style="font-size: 16px;">Datos Videojuego</p>
                      <div class="row d-flex">
                        <div class="col-md-6">
                          <label for="puntajeMaximo" class="form-label">Puntaje Máximo</label>
                          <input type="text" id="puntajeMaximo" class="form-control">
                        </div>
                        <div class="col-md-6">
                          <label for="nombreFabricante" class="form-label">Nombre del Fabricante</label>
                          <input type="text" id="nombreFabricante" class="form-control">
                        </div>
                      </div>
                    </div>                  
                  </div>

                  <!--CAMPOS NECESARIOS-->
                  <div id="otrosCampos" class="mt-3">
                    <p class="lead">ELEGIR</p>
                    <div class="row d-flex">
                      <div class="col-md-6">
                        <p class="lead" style="font-size: 16px;">Selecciona el pabellón en que quieres estár</p>
                        <select id="pabellonSelector" class="form-select form-select-sm" aria-label=".form-select-sm example">
                        </select>
                      </div>
                      <div class="col-md-6">
                        <p class="lead" style="font-size: 16px;">Si has pertenecido a equipos, seleccionalos..</p>
                        <select id="equipoSelector" class="form-select form-select-sm" aria-label=".form-select-sm example" multiple>
                        </select>
                      </div>
                    </div>
                  </div>

                </form>


              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" id="registerUserToEvent">Inscribirse</button>
              </div>
            </div>
          </div>
        </div>


    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/auth.js"></script>
    <script src="~/js/site.js"></script>
</body>
</html>